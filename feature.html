<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APX ULTRA V35 - PRO AI</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #030812;
  --panel: #0b1526;
  --neon: #00ff88; /* Green Theme for Accuracy */
  --neon-glow: 0 0 15px #00ff88;
  --text: #e0fbee;
}

body { margin:0; background:var(--bg); color:var(--text); font-family:'Rajdhani'; }
header { text-align:center; padding:25px; background:black; border-bottom:3px solid var(--neon); box-shadow:var(--neon-glow); }
.logo { font-family:'Orbitron'; font-size:30px; color:var(--neon); text-shadow:0 0 15px var(--neon); }

.container { max-width:480px; margin:20px auto; padding:15px; }
.panel { background:var(--panel); border-radius:20px; padding:25px; border:1px solid rgba(0,255,136,.3); box-shadow:0 0 30px rgba(0,255,136,.1); }

.tabs { display:flex; gap:10px; margin-bottom:20px; }
.tab { flex:1; padding:12px; border:1.5px solid var(--neon); background:transparent; color:var(--neon); border-radius:12px; font-weight:bold; cursor:pointer; transition:0.3s; font-family:'Orbitron'; font-size:12px; }
.tab.active { background:var(--neon); color:black; box-shadow:var(--neon-glow); }

select { width:100%; padding:12px; margin-bottom:15px; background:#050d1a; border:1px solid #1a3a3a; border-radius:10px; color:white; height:120px; }
input[type="time"] { width:46%; padding:12px; background:#050d1a; border:1px solid #1a3a3a; border-radius:10px; color:white; margin-bottom:15px; }

button { width:100%; padding:16px; margin-top:10px; border:none; border-radius:12px; font-family:'Orbitron'; font-weight:900; cursor:pointer; text-transform:uppercase; transition:0.2s; }
.generate { background:linear-gradient(135deg,#00ff88,#00ccff); color:black; box-shadow:var(--neon-glow); }
.generate:active { transform:scale(0.98); }
.telegram { background:#0088cc; color:white; margin-top:15px; }

#output { margin-top:25px; background:#02060e; padding:20px; border-radius:15px; border:1px dashed var(--neon); white-space:pre-wrap; font-family:monospace; font-size:13px; color:#afffdf; line-height:1.6; }
.loader-box { text-align:center; padding:30px; }
.bar-container { width:100%; background:#112211; height:10px; border-radius:5px; margin-top:10px; overflow:hidden; }
.bar-fill { height:100%; background:var(--neon); width:0%; transition: width 0.3s; box-shadow:0 0 10px var(--neon); }
</style>
</head>

<body>

<header><div class="logo">APX ULTRA V35</div></header>

<div class="container">
  <div class="panel">
    <div class="tabs">
      <button class="tab active" onclick="setMarket('OTC',this)">OTC MARKET</button>
      <button class="tab" onclick="setMarket('STOCK',this)">STOCKS</button>
      <button class="tab" onclick="setMarket('CRYPTO',this)">CRYPTO</button>
    </div>

    <select id="pairs" multiple></select>

    <div style="display:flex; justify-content:space-between;">
      <input type="time" id="start" value="10:00">
      <input type="time" id="end" value="12:00">
    </div>

    <button class="generate" onclick="generate()">ANALYZE & GENERATE</button>
    <button class="telegram" onclick="sendTG()">SEND TO TELEGRAM</button>

    <div id="output">SYSTEM READY FOR SCAN...</div>
  </div>
</div>

<script>
const API = "https://apx.mkapi009.workers.dev?pair=";
const TG = "https://signal.mkapi009.workers.dev/send";

let FINAL_SIGNALS = [];
let IS_LOCKED = false;

const ASSETS = {
  OTC: ["USDPKR-otc","USDBDT-otc","USDINR-otc","USDARS-otc","USDNGN-otc","BRLUSD-otc","USDMXN-otc","USDEGP-otc","USDIDR-otc"],
  STOCK: ["MSFSTK-otc","AXPSTK-OTC","PFESTK-otc","MCDSTK-otc","JNJSTK-otc"],
  CRYPTO: ["XAUUSD-otc","BTCUSD-otc","ETHUSD-otc"]
};

function setMarket(type, btn) {
  document.querySelectorAll(".tab").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
  const select = document.getElementById('pairs');
  select.innerHTML = "";
  ASSETS[type].forEach(p => {
    let opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p.replace(/-otc|-OTC/g, '').toUpperCase();
    select.appendChild(opt);
  });
}
setMarket("OTC", document.querySelector(".tab.active"));

// --- BRAIN LOGIC (ADAPTIVE AI STRATEGY) ---
function getRSI(data, period = 14) {
    if (data.length < period + 1) return 50;
    let gains = 0, losses = 0;
    for (let i = data.length - period; i < data.length; i++) {
        let diff = data[i].close - data[i-1].close;
        if (diff >= 0) gains += diff; else losses -= diff;
    }
    let rs = gains / (losses || 1);
    return 100 - (100 / (1 + rs));
}

function analyzeMarket(candles) {
  if (candles.length < 50) return null;
  
  let last = candles[candles.length - 1];
  let rsi = getRSI(candles);
  
  // EMA Cross Logic
  let smaShort = candles.slice(-10).reduce((a, b) => a + b.close, 0) / 10;
  let smaLong = candles.slice(-30).reduce((a, b) => a + b.close, 0) / 30;
  
  // Volatility Filter
  let body = Math.abs(last.close - last.open);
  let wick = (last.high - last.low) - body;

  // STRICT BRAIN LOGIC
  // CALL: Trend is up, RSI not overbought, Body is strong
  if (smaShort > smaLong && rsi < 65 && body > wick) return "CALL";
  // PUT: Trend is down, RSI not oversold, Body is strong
  if (smaShort < smaLong && rsi > 35 && body > wick) return "PUT";

  return null;
}

async function generate() {
  const selected = [...document.getElementById('pairs').selectedOptions].map(o => o.value);
  if (!selected.length) return alert("Please select pairs first!");

  IS_LOCKED = true;
  FINAL_SIGNALS = [];
  const output = document.getElementById('output');
  output.innerHTML = `<div class="loader-box">AI SCANNING MARKET...<div class="bar-container"><div class="bar-fill" id="pb"></div></div><div id="perc">0%</div></div>`;

  let pool = [];
  let progress = 0;

  for (const p of selected) {
    try {
      let res = await fetch(API + p);
      let json = await res.json();
      let trend = analyzeMarket(json.data || []);
      if (trend) pool.push({ pair: p.replace(/-otc|-OTC/gi, ''), dir: trend });
      
      progress += (100 / selected.length);
      document.getElementById('pb').style.width = progress + "%";
      document.getElementById('perc').innerText = Math.round(progress) + "%";
    } catch (e) { console.error(e); }
  }

  if (pool.length === 0) {
    output.innerText = "NO HIGH ACCURACY SETUP FOUND. TRY OTHER PAIRS.";
    return;
  }

  // Distribution
  const sTime = document.getElementById('start').value;
  const eTime = document.getElementById('end').value;
  let startMs = new Date("2026-01-01 " + sTime).getTime();
  let endMs = new Date("2026-01-01 " + eTime).getTime();
  if(endMs <= startMs) endMs += 86400000;

  for(let i=0; i<12; i++) {
    let randomTime = new Date(startMs + Math.random() * (endMs - startMs));
    let asset = pool[Math.floor(Math.random() * pool.length)];
    FINAL_SIGNALS.push({
      time: randomTime.toTimeString().slice(0,5),
      pair: asset.pair,
      dir: asset.dir
    });
  }
  
  FINAL_SIGNALS.sort((a,b) => a.time.localeCompare(b.time));
  renderOutput();
}

function renderOutput() {
  let txt = "üü¢ APX ULTRA V35 SIGNALS üü¢\n";
  txt += "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
  txt += "MODE: HIGH ACCURACY AI\n";
  txt += "EXPIRY: 1 MIN | GMT+5\n\n";
  FINAL_SIGNALS.forEach(s => {
    txt += `‚≠ê ${s.pair.padEnd(8)} | ${s.time} | ${s.dir}\n`;
  });
  txt += "\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
  txt += "‚ö†Ô∏è RULES: 1-STEP M-GALE\n";
  txt += "üö´ AVOID DURING NEWS\n";
  document.getElementById('output').innerText = txt;
}

async function sendTG() {
  if (!FINAL_SIGNALS.length) return alert("Generate signals first!");
  
  const header = "‚ö° APX ULTRA BRAIN SCAN ‚ö°\n\n";
  const stages = [
    { m: "üì° Connecting to Liquidity Provider...", p: " [üü©‚¨ú‚¨ú‚¨ú‚¨ú] 20%" },
    { m: "üß¨ Analyzing RSI & EMA Cross...", p: " [üü©üü©‚¨ú‚¨ú‚¨ú] 45%" },
    { m: "üìä Filtering Market Noise...", p: " [üü©üü©üü©‚¨ú‚¨ú] 70%" },
    { m: "üíé Finalizing High Precision Signals...", p: " [üü©üü©üü©üü©üü©] 100%" }
  ];

  try {
    for (let stage of stages) {
      await fetch(TG, { method: "POST", body: header + stage.m + "\n" + stage.p });
      await new Promise(r => setTimeout(r, 2000));
    }

    let finalMsg = "üíé APX ULTRA PREMIUM SIGNALS üíé\n";
    finalMsg += "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
    finalMsg += "üìÖ DATE: 2026-02-21\n";
    finalMsg += "‚è∞ ZONE: GMT +5\n";
    finalMsg += "‚åõ EXPIRY: 1 MIN\n";
    finalMsg += "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";
    
    FINAL_SIGNALS.forEach(s => {
      let icon = s.dir === "CALL" ? "üöÄ" : "üìâ";
      finalMsg += `${icon} ${s.pair} ‚ûî ${s.time} ‚ûî ${s.dir}\n`;
    });

    finalMsg += "\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
    finalMsg += "üìú TRADING RULES:\n";
    finalMsg += "‚úÖ Trade exactly at start of minute\n";
    finalMsg += "‚úÖ Use 1-Step Martingale (if needed)\n";
    finalMsg += "‚úÖ Best for OTC & High Volatility\n";
    finalMsg += "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
    finalMsg += "BY: APX ULTRA AI BOT ‚ú¥Ô∏è";

    await fetch(TG, { method: "POST", body: finalMsg });
    alert("Signals sent to Telegram with 100% Success!");
  } catch (e) {
    alert("Telegram Error. Check API.");
  }
}
</script>
</body>
</html>
