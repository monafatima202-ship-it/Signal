<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>APX ULTRA V14 NEON</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@600&display=swap" rel="stylesheet">

<style>
:root{
 --neon:#00fff2;
 --bg:#060b16;
 --panel:#0f172a;
 --call:#00ff88;
 --put:#ff2e63;
}
body{
 background:var(--bg);
 color:white;
 font-family:'Rajdhani';
 margin:0;
}
header{
 text-align:center;
 padding:15px;
 border-bottom:2px solid var(--neon);
 box-shadow:0 0 20px var(--neon);
 font-family:'Orbitron';
 color:var(--neon);
}
.container{
 max-width:500px;
 margin:auto;
 padding:15px;
}
.panel{
 background:var(--panel);
 border:1px solid rgba(0,255,242,0.3);
 border-radius:18px;
 padding:20px;
 box-shadow:0 0 25px rgba(0,255,242,0.2);
}
select,input,button{
 width:100%;
 padding:12px;
 margin-bottom:10px;
 border-radius:10px;
 border:1px solid #334155;
 background:#0b1220;
 color:white;
}
button{
 background:var(--neon);
 color:black;
 font-family:'Orbitron';
 font-weight:bold;
 cursor:pointer;
 box-shadow:0 0 10px var(--neon);
}
#output{
 margin-top:15px;
 white-space:pre;
 font-family:monospace;
 font-size:12px;
 border:1px dashed var(--neon);
 padding:15px;
 border-radius:12px;
}
</style>
</head>
<body>

<header>APX ULTRA NEON ENGINE V14</header>

<div class="container">
<div class="panel">

<select id="pairs" multiple size="12"></select>

Signals Count:
<input type="number" id="count" value="15" min="5" max="20">

<button onclick="generate()">GENERATE SMART SIGNALS</button>
<button onclick="sendTG()">SEND TELEGRAM</button>

<div id="output">READY...</div>

</div>
</div>

<script>

const API = "https://apx.mkapi009.workers.dev?pair=";
const TG  = "https://signal.mkapi009.workers.dev/send";

const ALL_PAIRS = [

 // OTC
 "USDPKR-otc","USDBDT-otc","USDINR-otc","USDARS-otc",
 "USDNGN-otc","BRLUSD-otc","USDMXN-otc",
 "USDEGP-otc","USDIDR-otc",

 // STOCK
 "MSFSTK-OTC","AXPSTK-OTC","PFESTK-OTC",
 "MCDSTK-OTC","JNJSTK-OTC","FABSTK-OTC","BOISTK-OTC",

 // CRYPTO
 "XAUUSD-otc","BTCUSD-otc"

];

let FINAL_SIGNALS = [];

const select = document.getElementById("pairs");
ALL_PAIRS.forEach(p=>{
 let o=document.createElement("option");
 o.value=p;
 o.textContent=p;
 select.appendChild(o);
});

/* ================= LOGIC ================= */

function EMA(data, period){
 let k = 2/(period+1);
 let ema = data[0].close;
 for(let i=1;i<data.length;i++){
   ema = data[i].close*k + ema*(1-k);
 }
 return ema;
}

function buildSignal(candles){

 if(candles.length < 100) return null;

 let last = candles.slice(-100);

 let ema20 = EMA(last.slice(-20),20);
 let ema50 = EMA(last.slice(-50),50);

 let trend = ema20 > ema50 ? "CALL" : "PUT";

 // momentum
 let momentum=0;
 let recent=last.slice(-6);

 for(let i=1;i<recent.length;i++){
   if(recent[i].close > recent[i-1].close) momentum++;
   else momentum--;
 }

 // rejection strength
 let strength=0;
 recent.forEach(c=>{
   let body=Math.abs(c.close-c.open);
   let range=c.high-c.low;
   if(range>0 && body/range>0.6) strength++;
 });

 if(trend==="CALL" && momentum>=2 && strength>=3) return "CALL";
 if(trend==="PUT" && momentum<=-2 && strength>=3) return "PUT";

 return null;
}

/* ================= ENGINE ================= */

async function generate(){

 FINAL_SIGNALS=[];
 const selected=[...select.selectedOptions].map(o=>o.value);
 const count=parseInt(document.getElementById("count").value);
 const output=document.getElementById("output");

 if(!selected.length){ alert("Select pairs"); return; }

 output.innerText="Analyzing Market Structure...";

 let now=new Date();

 for(let pair of selected){

   try{
     let res=await fetch(API+pair);
     let json=await res.json();
     let candles=json?.data || [];

     let direction=buildSignal(candles);

     if(!direction) continue;

     for(let i=1;i<=count;i++){
       let t=new Date(now.getTime()+i*60000);
       FINAL_SIGNALS.push({
         pair:pair.replace("-otc","").replace("-OTC",""),
         time:t.toTimeString().slice(0,5),
         dir:direction
       });
     }

   }catch(e){
     console.log(pair,"error");
   }
 }

 display();
}

function display(){

 const output=document.getElementById("output");

 if(!FINAL_SIGNALS.length){
   output.innerText="No High Probability Structure Found.";
   return;
 }

 let text="";

 FINAL_SIGNALS.forEach(s=>{
   text+=`${s.time} | ${s.pair.padEnd(8)} | ${s.dir}\n`;
 });

 output.innerText=text;
}

/* ================= TELEGRAM ================= */

async function sendTG(){

 if(!FINAL_SIGNALS.length){ alert("Generate first"); return; }

 let msg="✦═══ APX ULTRA SIGNALS ═══✦\n\n";
 msg+="UTC+6 | 1 Min Expiry\n";
 msg+="━━━━━━━━━━━━━━━━━━━━━━\n";
 msg+="```\n";

 FINAL_SIGNALS.forEach(s=>{
   msg+=`${s.time} | ${s.pair.padEnd(8)} | ${s.dir}\n`;
 });

 msg+="```\n";
 msg+="━━━━━━━━━━━━━━━━━━━━━━\n";
 msg+="1 Step MTG | Avoid News";

 await fetch(TG,{method:"POST",body:msg});
 alert("Sent to Telegram");
}

</script>
</body>
</html>
