<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APX PREMIUM SIGNALS</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
<style>
:root { --neon:#00ffcc; --bg:#010409; --call:#00ff88; --put:#ff3366; --gold:#ffcc00; }
body { margin:0; background:var(--bg); font-family:'Rajdhani'; color:white; }
header { padding:15px; text-align:center; border-bottom:2px solid var(--neon); background:black; }
.logo { font-family:'Orbitron'; color:var(--neon); font-size:18px; letter-spacing:2px; }
.container { max-width:450px; margin:20px auto; padding:10px; }
.panel { background:#0d1117; border:1px solid rgba(0,255,204,0.3); border-radius:15px; padding:20px; }
select, input { width:100%; padding:12px; background:#020617; color:white; border:1px solid #30363d; border-radius:10px; margin-bottom:12px; box-sizing: border-box; }
.main-btn { width:100%; padding:16px; background:var(--neon); color:black; border:none; border-radius:12px; font-family:'Orbitron'; font-weight:bold; cursor:pointer; }
#output { 
    margin-top:20px; 
    background:#05070a; 
    padding:15px; 
    border-radius:10px; 
    font-family: monospace; 
    white-space: pre; 
    line-height: 1.6;
    border: 1px solid #1a1d23;
}
.loading { text-align:center; color:var(--neon); font-family:'Orbitron'; padding:20px; }
</style>
</head>
<body>

<header>
    <div class="logo">APX PREMIUM ENGINE</div>
    <div id="clock" style="font-size:11px; color:var(--gold)">UTC+6 | LOADING...</div>
</header>

<div class="container">
    <div class="panel">
        <select id="pairs" multiple size="6">
            <option value="USDPKR-OTC">USDPKR-OTC</option>
            <option value="USDBDT-OTC" selected>USDBDT-OTC</option>
            <option value="USDINR-OTC">USDINR-OTC</option>
            <option value="USDCOP-OTC">USDCOP-OTC</option>
            <option value="EURUSD-OTC">EURUSD-OTC</option>
        </select>
        
        <div style="display:flex; gap:10px;">
            <input type="time" id="start" value="22:00">
            <input type="time" id="end" value="23:30">
        </div>

        <button class="main-btn" onclick="generatePremium()">GENERATE PREMIUM FEED</button>
        <div id="output">Signals will appear here...</div>
    </div>
</div>

<script>
const API = "https://candle.mkapi009.workers.dev/?pair=";

// Clock
setInterval(() => {
    let d = new Date();
    d.setHours(d.getUTCHours() + 6);
    document.getElementById('clock').innerText = "UTC+6 | " + d.toLocaleTimeString();
}, 1000);

async function generatePremium() {
    const output = document.getElementById('output');
    const selected = [...document.getElementById('pairs').selectedOptions].map(o => o.value);
    const sVal = document.getElementById('start').value;
    const eVal = document.getElementById('end').value;

    if (selected.length === 0) return alert("Select Pairs!");

    output.innerHTML = `<div class="loading">SCANNING MARKET DATA...</div>`;

    let now = new Date();
    let sTime = new Date(now.toDateString() + " " + sVal).getTime();
    let eTime = new Date(now.toDateString() + " " + eVal).getTime();
    if(eTime <= sTime) eTime += 86400000;

    let allSignals = [];

    for (let asset of selected) {
        let dir = "CALL"; 
        try {
            const res = await fetch(API + asset + "&count=50");
            const data = await res.json();
            if(data?.candles) {
                let bull = data.candles.filter(c => c.close > c.open).length;
                dir = bull >= 25 ? "CALL" : "PUT";
            }
        } catch(e) { dir = Math.random() > 0.5 ? "CALL" : "PUT"; }

        // Generate 5 fixed signals per pair within the range
        let step = (eTime - sTime) / 6; 
        for(let i=1; i<=5; i++) {
            let sigTime = new Date(sTime + (step * i));
            allSignals.push({
                pair: asset,
                time: sigTime.toTimeString().slice(0, 5),
                dir: dir,
                raw: sigTime.getTime()
            });
        }
    }

    allSignals.sort((a,b) => a.raw - b.raw);

    // Final Alignment (Image Style)
    let header = `UTC+6 Timezone\nExpiry: 1 Minute\nMoney Management: 1 Step MTG\n\n`;
    let body = "";
    allSignals.forEach(s => {
        let color = s.dir === "CALL" ? "#00ff88" : "#ff3366";
        body += `â—‡ ${s.pair.padEnd(10)} | ${s.time} | <span style="color:${color}">${s.dir}</span>\n`;
    });

    let footer = `\nTRADING RULES\nTrade only at signal time\nUse 1 Step Martingale\nAvoid high impact news\nStop after 2 losses\n\nPowered by APX Elite Premium`;

    output.innerHTML = header + body + footer;
}
</script>
</body>
</html>
