<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APX TRIGGER ENGINE</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
:root{
--bg:#02060c;
--panel:#0a111f;
--neon:#00ff88;
--cyan:#00ccff;
}
body{margin:0;background:var(--bg);color:white;font-family:'Rajdhani';}
header{text-align:center;padding:20px;background:black;border-bottom:3px solid var(--neon);}
.logo{font-family:'Orbitron';color:var(--neon);}
.container{max-width:480px;margin:20px auto;padding:15px;}
.panel{background:var(--panel);border-radius:20px;padding:25px;border:2px solid rgba(0,255,136,.3);}
.tabs{display:flex;gap:10px;margin-bottom:15px;}
.tab{flex:1;padding:10px;border:2px solid var(--neon);background:transparent;color:var(--neon);border-radius:8px;font-family:'Orbitron';cursor:pointer;}
.tab.active{background:linear-gradient(135deg,var(--neon),var(--cyan));color:black;}
select,input{width:100%;padding:12px;margin-bottom:15px;background:#050d1a;border:1px solid #1a3a3a;border-radius:10px;color:white;}
button{width:100%;padding:14px;margin-top:10px;border:none;border-radius:10px;font-family:'Orbitron';font-weight:bold;text-transform:uppercase;}
.generate{background:linear-gradient(135deg,#00ff88,#00ccff);color:black;}
.telegram{background:#0088cc;color:white;}
#output{margin-top:20px;background:#01040a;padding:15px;border-radius:12px;border:1px dashed var(--neon);white-space:pre-wrap;font-family:monospace;font-size:13px;min-height:180px;}
.loader-box{text-align:center;padding:20px;}
.bar-bg{width:100%;height:10px;background:#0d1e13;border-radius:10px;overflow:hidden;}
.bar-fill{
width:40%;
height:100%;
background:linear-gradient(90deg,#00ff88,#00ccff,#00ff88);
animation:move 1.2s linear infinite;
}
@keyframes move{
0%{margin-left:-40%;}
100%{margin-left:100%;}
}
</style>
</head>
<body>

<header><div class="logo">APX TRIGGER ENGINE</div></header>

<div class="container">
<div class="panel">

<div class="tabs">
<button class="tab active" onclick="setMarket('OTC',this)">OTC</button>
<button class="tab" onclick="setMarket('STOCK',this)">STOCK</button>
<button class="tab" onclick="setMarket('CRYPTO',this)">CRYPTO</button>
</div>

<select id="pairs" multiple size="6"></select>
<input type="time" id="start" value="21:00">

<button class="generate" onclick="scan()">TRIGGER SCAN</button>
<button class="telegram" onclick="sendTG()">SEND TELEGRAM</button>

<div id="output">READY...</div>

</div>
</div>

<script>
const API="https://apx.mkapi009.workers.dev?pair=";
const TG="https://signal.mkapi009.workers.dev/send";

let FINAL=[];
let RUN=false;

const ASSETS={
OTC:["USDPKR-otc","USDBDT-otc","USDINR-otc","USDARS-otc","USDNGN-otc","BRLUSD-otc","USDMXN-otc","USDEGP-otc","USDIDR-otc"],
STOCK:["MSFSTK-otc","AXPSTK-OTC","PFESTK-otc","MCDSTK-otc","JNJSTK-otc"],
CRYPTO:["XAUUSD-otc","BTCUSD-otc","ETHUSD-otc"]
};

function setMarket(type,btn){
document.querySelectorAll(".tab").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
let s=document.getElementById("pairs");
s.innerHTML="";
ASSETS[type].forEach(p=>{
let o=document.createElement("option");
o.value=p;
o.textContent=p.replace(/-otc|-OTC/gi,'');
s.appendChild(o);
});
}
setMarket("OTC",document.querySelector(".tab.active"));

function EMA(data,period){
let k=2/(period+1);
let ema=data[0].close;
for(let i=1;i<data.length;i++){
ema=data[i].close*k+ema*(1-k);
}
return ema;
}

function detectTriggers(data){
if(data.length<250)return [];
let signals=[];
for(let i=50;i<data.length-1;i++){
let slice=data.slice(i-50,i);
let ema20=EMA(slice,20);
let ema50=EMA(slice,50);
let last=data[i];

let score=0;

if(ema20>ema50)score++;
if(ema20<ema50)score--;

let momentum=0;
for(let j=i-10;j<i;j++){
let diff=data[j].close-data[j-1].close;
if(diff>0)momentum++;
if(diff<0)momentum--;
}
if(momentum>6)score+=2;
if(momentum<-6)score-=2;

let body=Math.abs(last.close-last.open);
let range=last.high-last.low||0.0001;
if(body/range>0.6)score+=1;

if(score>=3)signals.push({index:i,dir:"CALL"});
if(score<=-3)signals.push({index:i,dir:"PUT"});
}
return signals.slice(-15);
}

async function scan(){
if(RUN)return;
RUN=true;
FINAL=[];
let out=document.getElementById("output");
out.innerHTML=`<div class="loader-box">SCANNING STRUCTURE<div class="bar-bg"><div class="bar-fill"></div></div></div>`;

let selected=[...document.getElementById("pairs").selectedOptions].map(o=>o.value);
let start=new Date("2025-01-01 "+document.getElementById("start").value).getTime();

for(let pair of selected){
let res=await fetch(API+pair);
let j=await res.json();
let triggers=detectTriggers(j.data||[]);
triggers.forEach((t,k)=>{
FINAL.push({
time:new Date(start+(k*60000)).toTimeString().slice(0,5),
pair:pair.replace(/-otc|-OTC/gi,''),
dir:t.dir
});
});
}

if(FINAL.length===0){
out.innerText="NO VALID TRIGGERS FOUND.";
RUN=false;
return;
}

render();
RUN=false;
}

function render(){
let h="APX TRIGGER ENGINE\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nUTC+6 | 1 MIN EXP\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";
FINAL.forEach(s=>{
h+=`${s.pair.padEnd(10)} ${s.time}   ${s.dir}\n`;
});
h+="\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nReal Trigger Model\n";
document.getElementById("output").innerText=h;
}

async function sendTG(){
if(FINAL.length===0)return alert("Scan first.");

let stages=[
"üü©‚¨ú‚¨ú‚¨ú‚¨ú 20% Connecting...",
"üü©üü©‚¨ú‚¨ú‚¨ú 40% Reading Candles...",
"üü©üü©üü©‚¨ú‚¨ú 60% Detecting Triggers...",
"üü©üü©üü©üü©‚¨ú 80% Finalizing...",
"üü©üü©üü©üü©üü© 100% Ready!"
];

for(let s of stages){
await fetch(TG,{method:"POST",body:s});
await new Promise(r=>setTimeout(r,2000));
}

let msg="üìä APX TRIGGER ENGINE üìä\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nUTC+6 | 1 MIN EXP\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n```text\n";
FINAL.forEach(s=>{
msg+=`${s.pair.padEnd(10)} ${s.time}   ${s.dir}\n`;
});
msg+="```\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nTrade exact time\n1 Step Martingale\nStop after 2 losses\n\nPowered by APX Premium";

await fetch(TG,{method:"POST",body:msg});
alert("Sent!");
}
</script>
</body>
</html>
