<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APX NEURAL ENGINE V3</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
<style>
:root { --neon:#00ffcc; --bg:#010409; --call:#00ff88; --put:#ff3366; --gold:#ffcc00; }
body{ margin:0; background:var(--bg); font-family:'Rajdhani'; color:white; overflow-x:hidden; }
header{ padding:15px; text-align:center; border-bottom:2px solid var(--neon); background:black; box-shadow:0 0 20px rgba(0,255,204,0.4); }
.logo{ font-family:'Orbitron'; color:var(--neon); font-size:22px; text-transform:uppercase; letter-spacing:3px; }
.container{ max-width:450px; margin:20px auto; padding:10px; }
.panel{ background:#0d1117; border:1px solid var(--neon); border-radius:15px; padding:20px; position:relative; }
.tabs{ display:flex; gap:5px; margin-bottom:15px; }
.tab{ flex:1; padding:10px; border:1px solid var(--neon); background:transparent; color:var(--neon); border-radius:5px; cursor:pointer; font-weight:bold; font-size:11px; transition: 0.3s; }
.tab.active{ background:var(--neon); color:black; box-shadow:0 0 10px var(--neon); }
select,input{ width:100%; padding:12px; background:#020617; color:white; border:1px solid #30363d; border-radius:8px; margin-bottom:12px; box-sizing: border-box; font-family: 'Orbitron'; font-size: 13px; }
.main-btn{ width:100%; padding:18px; background:var(--neon); color:black; border:none; border-radius:10px; font-family:'Orbitron'; font-weight:bold; cursor:pointer; font-size:16px; transition: 0.2s; }
.main-btn:active{ transform: scale(0.98); }
#output{ margin-top:20px; border-radius:10px; background: rgba(255,255,255,0.02); min-height: 50px; }
.sig-row{ display:flex; justify-content:space-between; padding:12px; border-bottom:1px solid rgba(0,255,204,0.1); font-size: 15px; }
.time{ color:var(--gold); }
.CALL{ color:var(--call); font-weight:bold; }
.PUT{ color:var(--put); font-weight:bold; }
.loading{ text-align:center; padding:20px; color:var(--neon); font-family:'Orbitron'; font-size:12px; }
</style>
</head>
<body>

<header>
    <div class="logo">APX Neural Engine V3</div>
    <div id="clock" style="font-size:12px; margin-top:5px; color:var(--gold);">UTC+6 | LOADING...</div>
</header>

<div class="container">
    <div class="panel">
        <div class="tabs">
            <button class="tab active" onclick="setMarket('OTC',this)">OTC</button>
            <button class="tab" onclick="setMarket('STOCK',this)">STOCK</button>
            <button class="tab" onclick="setMarket('CRYPTO',this)">CRYPTO</button>
        </div>

        <select id="pairs" multiple size="6"></select>
        
        <div style="display:flex; gap:10px;">
            <input type="time" id="start" value="12:00">
            <input type="time" id="end" value="18:00">
        </div>

        <button class="main-btn" onclick="startEngine()">GENERATE SMART SIGNALS</button>
        <div id="output">Waiting for command...</div>
    </div>
</div>

<script>
const API = "https://candle.mkapi009.workers.dev/?pair=";
let SIGNALS = [];

const LIST = {
    OTC: ["USDPKR_otc","USDBDT_otc","USDCOP_otc","USDNGN_otc","USDINR_otc","USDBRL_otc","EURUSD_otc"],
    STOCK: ["MSFT_otc","AXP_otc","PFE_otc","AAPL_otc","FB_otc"],
    CRYPTO: ["BTCUSD_otc","ETHUSD_otc"]
};

// Clock Logic
setInterval(() => {
    let d = new Date();
    d.setHours(d.getUTCHours() + 6);
    document.getElementById('clock').innerText = "UTC+6 | " + d.toLocaleTimeString();
}, 1000);

function setMarket(t, b) {
    let pairsSelect = document.getElementById('pairs');
    pairsSelect.innerHTML = "";
    document.querySelectorAll(".tab").forEach(x => x.classList.remove("active"));
    b.classList.add("active");
    LIST[t].forEach(p => {
        let o = document.createElement("option");
        o.value = p;
        o.text = p.replace("_otc", "-OTC").toUpperCase();
        pairsSelect.add(o);
    });
}
setMarket("OTC", document.querySelector(".tab"));

// Brain Logic: Candle Pattern Analysis
function analyzeCandles(candles) {
    let last = candles[candles.length - 1];
    let prev = candles[candles.length - 2];
    
    let body = Math.abs(last.close - last.open);
    let wick = Math.max(last.high, last.low) - Math.max(last.close, last.open);
    
    // Neural Decision
    if (last.close > last.open && body > wick) return "CALL"; // Strong Bullish
    if (last.close < last.open && body > wick) return "PUT";  // Strong Bearish
    if (last.close > last.open && wick > body) return "PUT";  // Reversal (Pin Bar)
    return (last.close > prev.close) ? "CALL" : "PUT";        // Trend Follow
}

async function startEngine() {
    let pairsSelect = document.getElementById('pairs');
    let output = document.getElementById('output');
    let selected = [...pairsSelect.selectedOptions].map(o => o.value);
    
    if (selected.length === 0) return alert("Bhai, Assets toh select karo!");
    
    output.innerHTML = `<div class="loading">BRAIN INITIALIZING... READING CANDLES</div>`;
    SIGNALS = [];

    let sTime = document.getElementById('start').value;
    let eTime = document.getElementById('end.value');
    
    for (let asset of selected) {
        try {
            let pairAPI = asset.replace("_otc", "-OTC");
            let response = await fetch(API + pairAPI + "&count=30");
            let data = await response.json();
            
            if (data && data.candles) {
                let direction = analyzeCandles(data.candles);
                
                // Generate 3 signals for each selected pair
                for (let i = 0; i < 3; i++) {
                    let randomHour = Math.floor(Math.random() * 5); 
                    let randomMin = Math.floor(Math.random() * 59);
                    let timeStr = `${String(12 + i).padStart(2,'0')}:${String(randomMin).padStart(2,'0')}`;
                    
                    SIGNALS.push({
                        pair: pairAPI.toUpperCase(),
                        time: timeStr,
                        dir: direction
                    });
                }
            }
        } catch (e) { console.error("API Error"); }
    }

    displaySignals();
}

function displaySignals() {
    let output = document.getElementById('output');
    if (SIGNALS.length === 0) {
        output.innerHTML = "<div style='color:red; text-align:center;'>Market data not available. Try again.</div>";
        return;
    }
    
    output.innerHTML = "";
    SIGNALS.sort((a,b) => a.time.localeCompare(b.time));
    
    SIGNALS.forEach(s => {
        output.innerHTML += `
        <div class="sig-row">
            <span class="time">${s.time}</span>
            <span style="font-size:12px;">${s.pair}</span>
            <span class="${s.dir}">${s.dir}</span>
        </div>`;
    });
}
</script>
</body>
</html>
