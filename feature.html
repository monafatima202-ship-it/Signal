<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APX BALANCED PRO ENGINE</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
:root{
--bg:#02060c;
--panel:#0a111f;
--neon:#00ff88;
--cyan:#00ccff;
--text:#e0fbee;
}
body{margin:0;background:var(--bg);color:var(--text);font-family:'Rajdhani';}
header{text-align:center;padding:25px;background:black;border-bottom:4px solid var(--neon);}
.logo{font-family:'Orbitron';font-size:26px;color:var(--neon);}
.container{max-width:480px;margin:20px auto;padding:15px;}
.panel{background:var(--panel);border-radius:25px;padding:30px;border:2px solid rgba(0,255,136,.3);}
.tabs{display:flex;gap:10px;margin-bottom:20px;}
.tab{flex:1;padding:12px;border:2px solid var(--neon);background:transparent;color:var(--neon);border-radius:10px;font-family:'Orbitron';font-size:12px;cursor:pointer;}
.tab.active{background:linear-gradient(135deg,var(--neon),var(--cyan));color:black;}
select,input{width:100%;padding:14px;margin-bottom:18px;background:#050d1a;border:2px solid #1a3a3a;border-radius:12px;color:white;}
button{width:100%;padding:18px;margin-top:12px;border:none;border-radius:14px;font-family:'Orbitron';font-weight:900;text-transform:uppercase;}
.generate{background:linear-gradient(135deg,#00ff88,#00ccff);color:black;}
.telegram{background:#0088cc;color:white;}
#output{margin-top:25px;background:#01040a;padding:20px;border-radius:15px;border:2px dashed var(--neon);white-space:pre-wrap;font-family:monospace;font-size:13px;min-height:200px;}
.loader-box{text-align:center;padding:20px;}
.bar-bg{width:100%;background:#0d1e13;height:12px;border-radius:12px;margin:15px 0;overflow:hidden;}
.bar-fill{
height:100%;
width:40%;
background:linear-gradient(90deg,#00ff88,#00ccff,#00ff88);
animation:move 1.2s linear infinite;
}
@keyframes move{
0%{margin-left:-40%;}
100%{margin-left:100%;}
}
</style>
</head>
<body>

<header><div class="logo">APX BALANCED PRO</div></header>

<div class="container">
<div class="panel">

<div class="tabs">
<button class="tab active" onclick="setMarket('OTC',this)">OTC</button>
<button class="tab" onclick="setMarket('STOCK',this)">STOCK</button>
<button class="tab" onclick="setMarket('CRYPTO',this)">CRYPTO</button>
</div>

<select id="pairs" multiple size="6"></select>

<input type="time" id="start" value="21:00">
<input type="time" id="end" value="23:00">

<button class="generate" onclick="scan()">BALANCED SCAN</button>
<button class="telegram" onclick="sendTG()">SEND TO TELEGRAM</button>

<div id="output">SYSTEM READY...</div>

</div>
</div>

<script>
const API="https://apx.mkapi009.workers.dev?pair=";
const TG="https://signal.mkapi009.workers.dev/send";

let FINAL=[];
let SCANNING=false;

const ASSETS={
OTC:["USDPKR-otc","USDBDT-otc","USDINR-otc","USDARS-otc","USDNGN-otc","BRLUSD-otc","USDMXN-otc","USDEGP-otc","USDIDR-otc"],
STOCK:["MSFSTK-otc","AXPSTK-OTC","PFESTK-otc","MCDSTK-otc","JNJSTK-otc"],
CRYPTO:["XAUUSD-otc","BTCUSD-otc","ETHUSD-otc"]
};

function setMarket(type,btn){
document.querySelectorAll(".tab").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
let s=document.getElementById("pairs");
s.innerHTML="";
ASSETS[type].forEach(p=>{
let o=document.createElement("option");
o.value=p;
o.textContent=p.replace(/-otc|-OTC/gi,'');
s.appendChild(o);
});
}
setMarket("OTC",document.querySelector(".tab.active"));

function EMA(d,p){
let k=2/(p+1);
let e=d[d.length-p].close;
for(let i=d.length-p+1;i<d.length;i++){
e=d[i].close*k+e*(1-k);
}
return e;
}

function analyze(data){
if(data.length<200)return null;
let r=data.slice(-200);
let ema20=EMA(r,20);
let ema50=EMA(r,50);
let ema100=EMA(r,100);
let last=r[r.length-1];

let score=0;

if(ema20>ema50&&ema50>ema100)score+=4;
if(ema20<ema50&&ema50<ema100)score-=4;

let momentum=0;
for(let i=r.length-20;i<r.length;i++){
let diff=r[i].close-r[i-1].close;
if(diff>0)momentum++;
if(diff<0)momentum--;
}
if(momentum>5)score+=2;
if(momentum<-5)score-=2;

let high=Math.max(...r.slice(-25).map(x=>x.high));
let low=Math.min(...r.slice(-25).map(x=>x.low));
if(last.close>high)score+=2;
if(last.close<low)score-=2;

if(Math.abs(score)<2)return null;

return{
dir:score>0?"CALL":"PUT",
strength:Math.abs(score)
};
}

async function scan(){
if(SCANNING)return;
SCANNING=true;
FINAL=[];
let out=document.getElementById("output");
out.innerHTML=`<div class="loader-box">ANALYZING MARKET<div class="bar-bg"><div class="bar-fill"></div></div></div>`;

let selected=[...document.getElementById("pairs").selectedOptions].map(o=>o.value);
let pool=[];
for(let pair of selected){
let res=await fetch(API+pair);
let j=await res.json();
let d=analyze(j.data||[]);
if(d){
pool.push({pair:pair.replace(/-otc|-OTC/gi,''),dir:d.dir,str:d.strength});
}
}

if(pool.length===0){
out.innerText="MARKET TOO FLAT.";
SCANNING=false;
return;
}

pool.sort((a,b)=>b.str-a.str);

let start=new Date("2025-01-01 "+document.getElementById("start").value).getTime();
let end=new Date("2025-01-01 "+document.getElementById("end").value).getTime();
if(end<=start)end+=86400000;

let totalMinutes=Math.floor((end-start)/60000);
let signalCount=Math.min(18, totalMinutes);
let minuteGap=Math.max(1,Math.floor(totalMinutes/signalCount));

let current=start;

for(let i=0;i<signalCount;i++){
current+=minuteGap*60000;
let asset=pool[i%pool.length];
FINAL.push({
time:new Date(current).toTimeString().slice(0,5),
pair:asset.pair,
dir:asset.dir
});
}

render();
SCANNING=false;
}

function render(){
let h="APX BALANCED PRO\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nUTC+6 | 1 MIN EXP\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";
FINAL.forEach(s=>{
h+=`${s.pair.padEnd(10)} ${s.time}   ${s.dir}\n`;
});
h+="\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nBalanced Strength Model\n";
document.getElementById("output").innerText=h;
}

async function sendTG(){
if(FINAL.length===0)return alert("Scan first!");

let stages=[
"üü©‚¨ú‚¨ú‚¨ú‚¨ú 20%  Connecting...",
"üü©üü©‚¨ú‚¨ú‚¨ú 40%  Reading Candles...",
"üü©üü©üü©‚¨ú‚¨ú 60%  Scoring...",
"üü©üü©üü©üü©‚¨ú 80%  Finalizing...",
"üü©üü©üü©üü©üü© 100%  Ready!"
];

for(let s of stages){
await fetch(TG,{method:"POST",body:s});
await new Promise(r=>setTimeout(r,2000));
}

let msg="üìä APX BALANCED PRO üìä\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nUTC+6 | 1 MIN EXP\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n```text\n";
FINAL.forEach(s=>{
msg+=`${s.pair.padEnd(10)} ${s.time}   ${s.dir}\n`;
});
msg+="```\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nTrade exact time\n1 Step Martingale\nStop after 2 losses\n\nPowered by APX Premium";

await fetch(TG,{method:"POST",body:msg});
alert("Signals Sent!");
}
</script>
</body>
</html>
