<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APX ULTRA V37 - Final Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
:root{
--bg:#050b17;
--panel:#0f1a2e;
--neon:#00ffe7;
--neon-glow:0 0 12px #00ffe7,0 0 24px #00ffe7;
}
body{margin:0;background:var(--bg);color:white;font-family:'Rajdhani';min-height:100vh;}
header{text-align:center;padding:20px;background:black;border-bottom:2px solid var(--neon);box-shadow:var(--neon-glow);}
.logo{font-family:'Orbitron';font-size:28px;color:var(--neon);text-shadow:0 0 20px var(--neon);}
.container{max-width:500px;margin:20px auto;padding:10px;}
.panel{background:var(--panel);border-radius:18px;padding:20px;border:1px solid rgba(0,255,231,.2);box-shadow:0 0 25px rgba(0,255,231,.15);}
.tabs{display:flex;gap:8px;margin-bottom:15px;}
.tab{flex:1;padding:10px;border:1px solid var(--neon);background:transparent;color:var(--neon);border-radius:10px;font-weight:bold;cursor:pointer;}
.tab.active{background:var(--neon);color:black;box-shadow:var(--neon-glow);}
select,input[type="time"]{width:100%;padding:12px;margin-bottom:12px;background:#0a1326;border:1px solid #223654;border-radius:10px;color:white;}
button{width:100%;padding:14px;margin-top:8px;border:none;border-radius:12px;font-family:'Orbitron';font-weight:bold;cursor:pointer;}
.generate{background:linear-gradient(135deg,#00ffe7,#00c4ff);color:black;box-shadow:var(--neon-glow);}
.telegram{background:#0088cc;color:white;}
#output{margin-top:20px;background:#0a1326;padding:15px;border-radius:12px;border:1px dashed var(--neon);white-space:pre-wrap;font-family:monospace;min-height:200px;color:#d0f8ff;}
.loader{text-align:center;color:var(--neon);font-family:'Orbitron';padding:40px 0;}
</style>
</head>

<body>

<header>
<div class="logo">APX ULTRA V37</div>
</header>

<div class="container">
<div class="panel">

<div class="tabs">
<button class="tab active" onclick="setMarket('OTC',this)">OTC</button>
<button class="tab" onclick="setMarket('STOCK',this)">STOCK</button>
<button class="tab" onclick="setMarket('CRYPTO',this)">CRYPTO</button>
</div>

<select id="pairs" multiple></select>

<div style="display:flex;gap:10px">
<input type="time" id="start" value="15:00">
<input type="time" id="end" value="17:00">
</div>

<button class="generate" onclick="generate()">GENERATE HIGH QUALITY</button>
<button class="telegram" onclick="sendTG()">SEND TELEGRAM</button>

<div id="output">READY...</div>

</div>
</div>

<script>

const API="https://apx.mkapi009.workers.dev?pair=";
const TG="https://signal.mkapi009.workers.dev/send";

let FINAL=[];
let LOCK=false;

const LIST={
OTC:["USDPKR-otc","USDBDT-otc","USDINR-otc","USDARS-otc","USDNGN-otc","BRLUSD-otc","USDMXN-otc","USDEGP-otc","USDIDR-otc"],
STOCK:["MSFSTK-otc","AXPSTK-OTC","PFESTK-otc","MCDSTK-otc","JNJSTK-otc","FABSTK-otc","BOISTK-otc"],
CRYPTO:["XAUUSD-otc","BTCUSD-otc"]
};

function setMarket(type,btn){
document.querySelectorAll(".tab").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
pairs.innerHTML="";
LIST[type].forEach(p=>{
let o=document.createElement("option");
o.value=p;
o.textContent=p.replace(/-otc|-OTC/,'');
pairs.appendChild(o);
});
}
setMarket("OTC",document.querySelector(".tab.active"));

function EMA(data,period){
if(data.length<period)return null;
let k=2/(period+1);
let ema=data[data.length-period].close;
for(let i=data.length-period+1;i<data.length;i++){
ema=data[i].close*k+ema*(1-k);
}
return ema;
}

/* 500 Candle Strict Engine */
function analyze(c){
if(c.length<500)return null;

let r=c.slice(-500);

let ema20=EMA(r,20);
let ema50=EMA(r,50);
let ema100=EMA(r,100);
let ema200=EMA(r,200);

if(!ema20||!ema50||!ema100||!ema200)return null;

let score=0;

if(ema20>ema50&&ema50>ema100&&ema100>ema200)score+=3;
if(ema20<ema50&&ema50<ema100&&ema100<ema200)score-=3;

let momentum=0;
for(let i=r.length-20;i<r.length;i++){
let d=r[i].close-r[i-1].close;
if(d>0)momentum++;
if(d<0)momentum--;
}
if(momentum>10)score+=2;
if(momentum<-10)score-=2;

let last=r[r.length-1];
let high=Math.max(...r.slice(-50).map(x=>x.high));
let low=Math.min(...r.slice(-50).map(x=>x.low));

if(last.close>high)score+=2;
if(last.close<low)score-=2;

if(score>=5)return "CALL";
if(score<=-5)return "PUT";

return null;
}

async function generate(){
if(LOCK)return alert("Already Generated.");
LOCK=true;
FINAL=[];
output.innerHTML=`<div class="loader">SCANNING 500 CANDLES...</div>`;

const selected=[...pairs.selectedOptions].map(o=>o.value);
if(!selected.length){output.innerText="Select pairs!";LOCK=false;return;}

for(const p of selected){
try{
let r=await fetch(API+p);
let j=await r.json();
let candles=j?.data||[];
let dir=analyze(candles);
if(dir){
FINAL.push({
pair:p.replace(/-otc|-OTC/,''),
dir:dir
});
}
}catch{}
}

if(!FINAL.length){
output.innerText="No strong structure found.";
LOCK=false;
return;
}

distribute();
display();
}

function distribute(){
const s=start.value,e=end.value;
let now=new Date();
let startMs=new Date(now.toDateString()+" "+s).getTime();
let endMs=new Date(now.toDateString()+" "+e).getTime();
if(endMs<=startMs)endMs+=86400000;

const gap=(endMs-startMs)/FINAL.length;
let current=startMs;

FINAL=FINAL.map(obj=>{
current+=gap;
return{
time:new Date(current).toTimeString().slice(0,5),
pair:obj.pair,
dir:obj.dir
};
});
}

function display(){
let txt="APX ULTRA HIGH QUALITY\n";
txt+="‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
txt+="UTC+6 | 1 Min Expiry\n\n";
FINAL.forEach(s=>{
txt+=`‚û§ ${s.pair.padEnd(12)} ${s.time}   ${s.dir}\n`;
});
txt+="\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
txt+="TRADING RULES\n";
txt+="‚Ä¢ Trade exact time\n";
txt+="‚Ä¢ 1 Step Martingale\n";
txt+="‚Ä¢ Avoid News\n";
txt+="‚Ä¢ Stop after 2 losses\n\n";
txt+="Powered by ‚ú¥Ô∏è APX Premium";
output.innerText=txt;
}

async function sendTG(){
if(!FINAL.length)return alert("Generate first!");

await fetch(TG,{method:"POST",body:
`‚ú¶‚ïê‚ï° APX ULTRA SIGNALS ‚ïû‚ïê‚ú¶

üü©‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú 10%`});
await new Promise(r=>setTimeout(r,4000));

await fetch(TG,{method:"POST",body:
`‚ú¶‚ïê‚ï° APX ULTRA SIGNALS ‚ïû‚ïê‚ú¶

üü©üü©üü©üü©‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú 40%`});
await new Promise(r=>setTimeout(r,4000));

await fetch(TG,{method:"POST",body:
`‚ú¶‚ïê‚ï° APX ULTRA SIGNALS ‚ïû‚ïê‚ú¶

üü©üü©üü©üü©üü©üü©üü©üü©‚¨ú‚¨ú 80%`});
await new Promise(r=>setTimeout(r,4000));

let msg=`‚ú¶‚ïê‚ï° APX ULTRA SIGNALS ‚ïû‚ïê‚ú¶

UTC+6 Timezone | 1 Min Expiry
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
\`\`\`text
`;

FINAL.forEach(s=>{
msg+=`‚ú¶ ${s.time.padEnd(6)} ${s.pair.padEnd(10)} ${s.dir}\n`;
});

msg+=`\`\`\`
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
TRADING RULES
‚Ä¢ Trade exact time
‚Ä¢ 1 Step Martingale
‚Ä¢ Avoid News
‚Ä¢ Stop after 2 losses

Powered by ‚ú¥Ô∏è APX Premium`;

await fetch(TG,{method:"POST",body:msg});
alert("Signals Sent Successfully!");
}

</script>
</body>
</html>
