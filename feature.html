<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>APX PRO ENGINE</title>

<style>
body{
background:#041622;
color:white;
font-family:Arial;
text-align:center;
padding:20px;
}

h2{ color:#00ffc3; }

.card{
background:#082033;
padding:20px;
border-radius:15px;
max-width:520px;
margin:auto;
}

select,input,button{
width:95%;
padding:12px;
margin:6px;
border-radius:8px;
border:none;
font-size:15px;
}

button{
background:#00ffc3;
color:#002b24;
font-weight:bold;
cursor:pointer;
}

#out{
margin-top:20px;
background:#021018;
padding:15px;
border-radius:10px;
white-space:pre-line;
text-align:left;
}
</style>
</head>

<body>

<h2>üî• APX ULTRA PREMIUM üî•</h2>
<p>UTC+6 Timezone ‚Ä¢ PRO API Candle Engine</p>

<div class="card">

<select id="mode">
<option value="single">Single Pair</option>
<option value="multi">Multiple Pair</option>
</select>

<select id="pairs" multiple size="8">
<option>USDPKR-OTC</option>
<option>USDINR-OTC</option>
<option>USDBRL-OTC</option>
<option>USDMXN-OTC</option>
<option>USDBDT-OTC</option>
<option>USDARS-OTC</option>
<option>USDEGP-OTC</option>
<option>ETHUSD-OTC</option>
<option>BNBUSD-OTC</option>
<option>MSFT</option>
<option>PFE</option>
<option>AXP</option>
<option>INTC</option>
</select>

<button onclick="generate()">üöÄ Generate API Signals</button>
<button onclick="sendTG()">üì© Send Telegram</button>

<div id="out">Waiting...</div>

</div>

<script>

const API="https://candle.mkapi009.workers.dev";
const TG="https://signal.mkapi009.workers.dev/send";

let SIGNAL_CACHE={};
let SIGNALS=[];

// ===== API =====
async function getCandles(pair){
let r=await fetch(API+`/?pair=${pair}&count=60`);
let j=await r.json();
return j.candles.reverse();
}

// ===== MARKET TIME =====
function getMarketTime(c){
return c[c.length-1].candle_time;
}

// ===== PRO SIGNAL =====
function buildSignals(c,pair){

let list=[];

for(let i=15;i<c.length;i++){

let a=c[i-4].close;
let b=c[i-3].close;
let d=c[i-2].close;
let e=c[i-1].close;
let f=c[i].close;

let up=0,down=0;

if(b>a) up++; else down++;
if(d>b) up++; else down++;
if(e>d) up++; else down++;
if(f>e) up++; else down++;

if(up>=4 || down>=4){

let dir=up>down?"CALL":"PUT";

let t=new Date();
t.setMinutes(t.getMinutes()+i);

list.push({
pair:pair.replace("-OTC",""),
time:t.toTimeString().slice(0,5),
dir
});

}

}

return list;
}

// ===== GENERATE =====
async function generate(){

SIGNALS=[];
out.innerText="Reading PRO Market Structure...";

let selected=[...pairs.selectedOptions].map(o=>o.value);

if(mode.value==="single"){
selected=selected.slice(0,1);
}

for(let p of selected){

let c=await getCandles(p);
let market=getMarketTime(c);

if(
SIGNAL_CACHE[p] &&
SIGNAL_CACHE[p].market===market
){
SIGNALS.push(...SIGNAL_CACHE[p].signals);
}
else{

let sig=buildSignals(c,p).slice(0,5);

SIGNAL_CACHE[p]={
market:market,
signals:sig
};

SIGNALS.push(...sig);
}

}

SIGNALS=SIGNALS.slice(0,15);

show();
}

// ===== DISPLAY =====
function show(){

out.innerText=
`üî• APX ULTRA PREMIUM üî•

${SIGNALS.map(s=>`‚ßâ ${s.pair} ${s.time} ‚û£ ${s.dir}`).join("\n")}

====================
UTC+6 Timezone
Expiry: 1 Minute
Money Management: 1 Step MTG
====================

TRADING RULES
1Ô∏è‚É£ Trade only at signal time
2Ô∏è‚É£ Use 1 Step Martingale only
3Ô∏è‚É£ Avoid high impact news
4Ô∏è‚É£ Stop after 2 losses
5Ô∏è‚É£ Trade with trend direction

üëë Powered by APX Elite Premium`;
}

// ===== TELEGRAM =====
async function sendTG(){

let text=
`üî• APX ULTRA PREMIUM üî•

${SIGNALS.map(s=>`‚ßâ ${s.pair} ${s.time} ‚û£ ${s.dir}`).join("\n")}

====================
UTC+6 Timezone
Expiry: 1 Minute
Money Management: 1 Step MTG
====================

TRADING RULES
1Ô∏è‚É£ Trade only at signal time
2Ô∏è‚É£ Use 1 Step Martingale only
3Ô∏è‚É£ Avoid high impact news
4Ô∏è‚É£ Stop after 2 losses
5Ô∏è‚É£ Trade with trend direction

üëë Powered by APX Elite Premium`;

await fetch(TG,{
method:"POST",
body:text
});

alert("Sent To Telegram");
}

</script>

</body>
</html>
